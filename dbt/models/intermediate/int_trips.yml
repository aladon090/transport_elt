version: 2

models:
  - name: int_yellow_taxi
    description: "Enriched yellow taxi data with zone names added."
    columns:
      - name: pickup_zone
      - name: dropoff_zone
      - name: taxi_color
        tests:
          - accepted_values:
              values: ["yellow"]

  - name: int_green_taxi
    description: "Enriched green taxi data with zone names added."
    columns:
      - name: pickup_zone
      - name: dropoff_zone
      - name: taxi_color
        tests:
          - accepted_values:
              values: ["green"]

  - name: int_all_trips
    description: "Unified all taxi trips (yellow + green) with standardized fields and enriched metadata."
    tests:
      - unique:
          column_name: "vendor_id || pickup_datetime || dropoff_datetime"
          config:
            severity: warn

    columns:
      - name: taxi_color
      - name: pickup_zone
      - name: dropoff_zone
      - name: trip_distance_miles
      - name: fare_amount_usd
      - name: tip_amount_usd
      - name: total_amount_usd
      - name: passenger_count
      - name: pickup_datetime
        tests:
          - not_null
      - name: dropoff_datetime
